var M=Object.defineProperty;var y=(o,t,e)=>t in o?M(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var x=(o,t,e)=>(y(o,typeof t!="symbol"?t+"":t,e),e);import{r as c,j as r,B as C}from"./index-WbGlwQ5S.js";import{H as w}from"./index-X7IqoI0i.js";import{D as I}from"./cjs-Z9Gpgza5.js";import{D as T}from"./index-32-IcSLY.js";const z={trigger:!1,index:0,percent:0,th:new Date().getFullYear()-2008-1,data:{}},v=c.createContext([z,()=>{}]),H=c.forwardRef((o,t)=>{const e=c.useRef(null),[,s]=c.useContext(v),i=c.useRef(null),[n,a]=c.useState(0),h=c.useRef(window.innerHeight);c.useEffect(()=>{const u=()=>{var f;i.current&&a(((f=i.current)==null?void 0:f.getBoundingClientRect().width)-20||0),h.current!==window.innerWidth&&(s(g=>({...g,percent:0})),h.current=window.innerWidth),e.current&&e.current.setState(g=>({...g,x:0}))};return u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]);const d=(u,f)=>{const g=f.x/n;s(b=>({...b,percent:g}))};return c.useImperativeHandle(t,()=>({set(u){var f,g;if(e.current&&e.current.props.bounds&&typeof((f=e.current)==null?void 0:f.props.bounds)=="object"){const{right:b}=e.current.props.bounds;b&&((g=e.current)==null||g.setState(j=>{let m=j.x+u;m<0&&(m=0),m>b&&(m=b);const N=m/n;return s(S=>({...S,percent:N})),{...j,x:m}}))}}})),r.jsx("div",{className:"scroll",children:r.jsx("div",{ref:i,className:"bar",children:i.current&&r.jsx(I,{ref:e,onDrag:d,axis:"x",bounds:{left:0,right:n},children:r.jsx("div",{className:"btn"})})})})}),O=c.memo(({data:o,index:t})=>{const[,e]=c.useContext(v);return r.jsxs("div",{className:"slide",children:[r.jsxs("div",{className:"title",children:[r.jsx("h2",{children:o.name}),r.jsx("div",{}),r.jsx("span",{children:o.engName})]}),r.jsx("div",{className:"content",dangerouslySetInnerHTML:{__html:o.html.replace(/(<([^>]+)>)/gi,"").replace(/(&nbsp;)*/g,"").slice(0,63)+"..."}}),r.jsx("div",{className:"w-full flex justify-end",children:r.jsx(C,{onClick:()=>e(s=>({...s,index:t,trigger:!0})),children:r.jsx(C.More,{size:"small",children:"More"})})})]})}),_=c.memo(()=>{const[o]=c.useContext(v),[t]=c.useContext(w),{percent:e,th:s,data:i}=o,n=c.useMemo(()=>Object.keys(i).length===0?[]:Object.values(i)[s-1],[s,i]),a=c.useMemo(()=>{const{share:l}=t;return l.filter(p=>p.session===s)},[s,t]),h=c.useRef(null),d=c.useRef(null),u=c.useRef(n.length*272),f=c.useRef({x:0,enabled:!1}),[g,b]=c.useState(0),[j,m]=c.useState(!1),N=()=>{if(h.current){const{width:l}=h.current.getBoundingClientRect();b(u.current-l),m(l<u.current)}},S=c.useMemo(()=>{const l=n.length*272;return u.current=l,N(),l},[n]);c.useEffect(()=>{const l=()=>N();return l(),window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]);const D=c.useMemo(()=>{if(g<=0)return 0;const l=g+96;return e>=1?0-l:0-l*e},[e,g]),W=l=>{d.current&&d.current.set(l.deltaX)};return r.jsxs("div",{className:"Carousel",children:[r.jsx("div",{ref:h,className:"w-full overflow-x-hidden pl-12 pr-5 py-10",children:r.jsx("div",{style:{width:`${S}px`,transform:`translateX(${D}px)`},className:"flex flex-nowrap space-x-5 duration-100",onWheel:W,onTouchStart:l=>{f.current.enabled=!0,f.current.x=l.touches[0].pageX},onTouchMove:l=>{var R;const p=l.touches[0].pageX,E=Math.floor(f.current.x-p);(R=d.current)==null||R.set(E),f.current.x=p},onTouchEnd:()=>{f.current.enabled=!1},children:a==null?void 0:a.map((l,p)=>r.jsx(O,{data:l,index:p},JSON.stringify(l)+p))})}),j&&r.jsx(H,{ref:d})]})}),K=["","十","百","千","萬","十","百","千","億","十","百","千","兆","十","百","千"],L=["","十","百","千","万","十","百","千","亿","十","百","千","兆","十","百","千"],U=(o="zh-TW")=>o==="zh-TW"?"點":"点";function $(o,t="zh-TW"){const e=t==="zh-TW"?K:L,i=o.toString().split("."),n=i[0],a=i[1];let h="";for(let d=0;d<n.length;d++){const u=parseInt(n[d]).toLocaleString("zh-Hans-CN-u-nu-hanidec",{useGrouping:!1}),f=e[n.length-d-1],g=u!=="〇"||["萬","万","億","亿","兆"].includes(f)?u+f:u;h+=g}if(a){h+=U(t);for(let d=0;d<a.length;d++){const u=parseInt(a[d]).toLocaleString("zh-Hans-CN-u-nu-hanidec",{useGrouping:!1});h+=u}}return h=h.replace(/〇+/g,"〇").replace(/〇(萬|万|億|亿|兆)/g,"$1").replace(/〇+$/,""),h}const k=c.memo(()=>{const[o]=c.useContext(w),[t,e]=c.useContext(v),{th:s,index:i}=t,{share:n}=o,a=c.useMemo(()=>n.filter(u=>u.session===s)[i],[s,i,n]),h=c.useMemo(()=>{const u=2009+s-1,f=$(s,"zh-TW");return`${u} 第${f}屆紅領帶`},[s]),d=c.useMemo(()=>s===2?"nd":s===3?"rd":"th",[s]);return r.jsx("div",{className:"Detail",children:r.jsx(T,{closeButton:r.jsx(C,{onClick:()=>e(u=>({...u,trigger:!1})),children:r.jsx(C.Close,{})}),children:r.jsxs("div",{className:"w-full p-20",children:[r.jsxs("div",{className:"header",children:[r.jsxs("h2",{children:[s,r.jsx("span",{children:d})]}),r.jsx("hr",{}),r.jsxs("div",{className:"sub",children:[r.jsx("span",{children:h}),r.jsx("br",{}),r.jsxs("h3",{children:[a.name," ",a.engName]})]})]}),r.jsx("div",{className:"body",dangerouslySetInnerHTML:{__html:a.html}})]})})})}),B=c.memo(({children:o,onChange:t,defaultValue:e})=>r.jsx("select",{className:"Select",onChange:t,defaultValue:e,children:o}));class X{constructor(t={}){x(this,"options");x(this,"standardNumbers");x(this,"standardNumbersReverse");x(this,"digits");x(this,"bigNumbers");x(this,"biggest");x(this,"reg10K");x(this,"reg");x(this,"biggest_in_arabic",1e48);this.options={zeroChar:"零"},this.options=Object.assign(this.options,t),this.standardNumbers={1:"一",2:"二",3:"三",4:"四",5:"五",6:"六",7:"七",8:"八",9:"九"},this.standardNumbersReverse={一:1,二:2,两:2,三:3,四:4,五:5,六:6,七:7,八:8,九:9,十:10,百:100,千:1e3,万:1e4,亿:1e8,兆:1e12,京:1e16,垓:1e20,秭:1e24,穰:1e28,沟:1e32,涧:1e36,正:1e40,载:1e44},this.digits=[{value:1e3,char:"千"},{value:100,char:"百"},{value:10,char:"十"}],this.bigNumbers=[{value:1e44,char:"载"},{value:1e40,char:"正"},{value:1e36,char:"涧"},{value:1e32,char:"沟"},{value:1e28,char:"穰"},{value:1e24,char:"秭"},{value:1e20,char:"垓"},{value:1e16,char:"京"},{value:1e12,char:"兆"},{value:1e8,char:"亿"},{value:1e4,char:"万"}],this.biggest="九千九百九十九"+this.bigNumbers.map(e=>e.char).join("九千九百九十九")+"九千九百九十九",this.reg10K=/(.){1}(千|百|十)/g,this.reg=/(.+?)(万|亿|兆|京|垓|秭|穰|沟|涧|正|载)/g}toChinese(t){if(t>this.biggest_in_arabic)throw new Error("Number to large, Unable to process!");let e="";this.bigNumbers.forEach(i=>{const n=Math.floor(t/i.value);if(n>0){const a=this.toChineseUnder10K(n);a.length>1&&a[1]!=="千"?e+="零"+a+i.char:e+=a+i.char,t-=n*i.value}});const s=this.toChineseUnder10K(t);return s.length===1||s[1]!=="千"?e=e+"零"+s:e=e+s,e.startsWith("零")&&(e=e.slice(1)),e.replace(/^一十/,"十")}toChineseUnder10K(t){if(t>9999)return"";let e="",s=0,i=!1;this.digits.forEach((a,h)=>{const d=parseInt(`${t/a.value}`);d>0&&(h>s+1&&i&&(e+=this.options.zeroChar),s=h,i=!0,e+=this.standardNumbers[d]+a.char,t-=d*a.value)});let n=this.standardNumbers[t];return n&&(e.length>1&&!e.endsWith("十")&&(n="零"+n),e+=n),e}toArabic(t){let e=0,s=0,i=0,n;do{if(n=this.reg.exec(t),!n)break;const a=n[1];i=a.length+1;const h=n[2];s=n.index,e+=this.toArabicUnder10K(a)*this.standardNumbersReverse[h]}while(n);if(t.length>s+i){let a=t.slice(s+i);a=a.replace(/^零/,"");const h=this.toArabicUnder10K(a);e+=h}return e}toArabicUnder10K(t){if(t.length===1)return this.standardNumbersReverse[t];if(t.length===2&&t[0]==="十")return 10+this.standardNumbersReverse[t[1]];let e=0,s,i=0,n="";do{if(s=this.reg10K.exec(t),!s)break;const a=s[1];n=s[2],i=s.index,e+=this.standardNumbersReverse[a]*this.standardNumbersReverse[n]}while(s);return t.length>i+2&&(t[i+2]==="零"?e+=this.standardNumbersReverse[t[i+3]]:e+=this.standardNumbersReverse[t[i+2]]*this.standardNumbersReverse[n]/10),e}}const A=new X,P=c.memo(()=>{const[o,t]=c.useContext(v),{data:e}=o,s=new Date().getFullYear();return r.jsxs("div",{className:"Header",children:[r.jsxs("div",{children:[r.jsx("div",{className:"title",children:"而紅領帶相信……"}),r.jsx("div",{className:"select",children:r.jsx(B,{onChange:i=>{t(n=>({...n,th:Number(i.target.value)}))},defaultValue:o.th,children:Object.keys(e).map(i=>r.jsxs("option",{value:Object.keys(e).length-parseInt(i)+1,children:[s-parseInt(i)+1," 第",A.toChinese(Object.keys(e).length-parseInt(i)+1),"屆"]},`option-${i}`))})})]}),r.jsx("div",{children:"每一屆的紅領帶，都在這裡封存了他們的身為紅領帶的心情與學習。探探學長姐的腦袋，看看他們在紅領帶的兩個月後得到什麼、失去什麼、擁有什麼又拋下了什麼。"})]})}),q=c.memo(()=>{const o=c.useState(z),[,t]=o,e=c.useContext(w),{share:s}=e[0];return c.useEffect(()=>{if(s.length>0){const i=s.reduce((n,a)=>(n[a.session]?n[a.session].push(a):n[a.session]=[a],n),{});t(n=>({...n,th:Object.keys(i).length,data:i}))}},[s]),r.jsx(v.Provider,{value:o,children:r.jsxs("section",{id:"share",className:"Share",children:[r.jsx(P,{}),r.jsx(_,{}),o[0].trigger&&r.jsx(k,{})]})})});export{q as default};
